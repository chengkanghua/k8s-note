





# 问题： slave2上的fluentd 容器始终处于ContainerCreating状态

没有发现其他报错问题，不知道如何解决了，删除掉重新创建过很多次也是一样

```bash

[root@k8s-master efk]# kubectl label node k8s-slave1 fluentd=true
node/k8s-slave1 labeled
[root@k8s-master efk]# kubectl label node k8s-slave2 fluentd=true
node/k8s-slave2 labeled
[root@k8s-master efk]# kubectl get no --show-labels
NAME         STATUS   ROLES                  AGE   VERSION   LABELS
k8s-master   Ready    control-plane,master   14d   v1.21.5   beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,ingress=true,kubernetes.io/arch=amd64,kubernetes.io/hostname=k8s-master,kubernetes.io/os=linux,node-role.kubernetes.io/control-plane=,node-role.kubernetes.io/master=,node.kubernetes.io/exclude-from-external-load-balancers=
k8s-slave1   Ready    <none>                 14d   v1.21.5   beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,component=mysql,fluentd=true,kubernetes.io/arch=amd64,kubernetes.io/hostname=k8s-slave1,kubernetes.io/os=linux
k8s-slave2   Ready    <none>                 14d   v1.21.5   beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,fluentd=true,kubernetes.io/arch=amd64,kubernetes.io/hostname=k8s-slave2,kubernetes.io/os=linux
[root@k8s-master efk]# kubectl apply -f fluentd-es-config-main.yaml
configmap/fluentd-es-config-main created
[root@k8s-master efk]# kubectl apply -f fluentd-configmap.yaml
configmap/fluentd-config created
[root@k8s-master efk]# kubectl apply -f fluentd.yaml
serviceaccount/fluentd-es unchanged
clusterrole.rbac.authorization.k8s.io/fluentd-es unchanged
clusterrolebinding.rbac.authorization.k8s.io/fluentd-es configured
daemonset.apps/fluentd-es created
[root@k8s-master efk]# kubectl -n logging get po -o wide
NAME                      READY   STATUS              RESTARTS   AGE     IP            NODE         NOMINATED NODE   READINESS GATES
elasticsearch-0           1/1     Running             0          25m     10.244.2.67   k8s-slave2   <none>           <none>
elasticsearch-1           1/1     Running             1          4h13m   10.244.2.59   k8s-slave2   <none>           <none>
elasticsearch-2           1/1     Running             0          25m     10.244.1.92   k8s-slave1   <none>           <none>
fluentd-es-g9v4s          0/1     ContainerCreating   0          5s      <none>        k8s-slave2   <none>           <none>
fluentd-es-vm2nq          1/1     Running             0          5s      10.244.1.95   k8s-slave1   <none>           <none>
kibana-5f568b7b7c-rjwf5   1/1     Running             0          3h46m   10.244.2.64   k8s-slave2   <none>           <none>
[root@k8s-master efk]# kubectl -n logging describe fluentd-es-g9v4s
error: the server doesn't have a resource type "fluentd-es-g9v4s"
[root@k8s-master efk]# kubectl -n logging describe po fluentd-es-g9v4s
Name:           fluentd-es-g9v4s
Namespace:      logging
Priority:       0
Node:           k8s-slave2/10.211.55.27
Start Time:     Mon, 24 Oct 2022 20:22:06 +0800
Labels:         controller-revision-hash=665bdb8c65
                k8s-app=fluentd-es
                pod-template-generation=1
Annotations:    <none>
Status:         Pending
IP:
IPs:            <none>
Controlled By:  DaemonSet/fluentd-es
Containers:
  fluentd-es:
    Container ID:
    Image:          quay.io/fluentd_elasticsearch/fluentd:v3.1.0
    Image ID:
    Port:           <none>
    Host Port:      <none>
    State:          Waiting
      Reason:       ContainerCreating
    Ready:          False
    Restart Count:  0
    Limits:
      memory:  500Mi
    Requests:
      cpu:        100m
      memory:     200Mi
    Environment:  <none>
    Mounts:
      /etc/fluent/config.d from config-volume (rw)
      /var/lib/docker/containers from varlibdockercontainers (ro)
      /var/log from varlog (rw)
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-vqk58 (ro)
Conditions:
  Type              Status
  Initialized       True
  Ready             False
  ContainersReady   False
  PodScheduled      True
Volumes:
  varlog:
    Type:          HostPath (bare host directory volume)
    Path:          /var/log
    HostPathType:
  varlibdockercontainers:
    Type:          HostPath (bare host directory volume)
    Path:          /var/lib/docker/containers
    HostPathType:
  config-volume:
    Type:      ConfigMap (a volume populated by a ConfigMap)
    Name:      fluentd-config
    Optional:  false
  kube-api-access-vqk58:
    Type:                    Projected (a volume that contains injected data from multiple sources)
    TokenExpirationSeconds:  3607
    ConfigMapName:           kube-root-ca.crt
    ConfigMapOptional:       <nil>
    DownwardAPI:             true
QoS Class:                   Burstable
Node-Selectors:              fluentd=true
Tolerations:                 node.kubernetes.io/disk-pressure:NoSchedule op=Exists
                             node.kubernetes.io/memory-pressure:NoSchedule op=Exists
                             node.kubernetes.io/not-ready:NoExecute op=Exists
                             node.kubernetes.io/pid-pressure:NoSchedule op=Exists
                             node.kubernetes.io/unreachable:NoExecute op=Exists
                             node.kubernetes.io/unschedulable:NoSchedule op=Exists
Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  37s   default-scheduler  Successfully assigned logging/fluentd-es-g9v4s to k8s-slave2
  Normal  Pulling    36s   kubelet            Pulling image "quay.io/fluentd_elasticsearch/fluentd:v3.1.0"
  
[root@k8s-master efk]# kubectl -n logging logs fluentd-es-g9v4s
Error from server (BadRequest): container "fluentd-es" in pod "fluentd-es-g9v4s" is waiting to start: ContainerCreating
```

